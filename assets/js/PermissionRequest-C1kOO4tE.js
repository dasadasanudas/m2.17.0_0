import{n as s,b as e,P as t,k as i,p as r}from"./icon-alert-Cei3Tz55.js";import{S as o}from"./SmoothReflow-DOlTFzdt.js";import{_ as n}from"./icon-down-BiHbKN-t.js";import"./localStorage-BThj8CCp.js";import"./preload-helper-xKIU3iAw.js";import"./string-CbqVM-Zr.js";import"./allComponentsMounted-C3UsG_cA.js";const a=s({name:"PermissionRequest",components:{SmoothReflow:o},props:{reason:{type:String,default:"To use this feature"},source:{type:String,default:"Momentum"},permissions:{type:Object,default:()=>{}},requestImmediately:{type:Boolean,default:!1},resolve:{type:Function,default:()=>{}},extraInstructions:{type:String,default:""},watchPermissionCheck:{type:Boolean,default:!1}},setup:()=>({browser:e.getBrowser()}),data:()=>({browserRequestOpen:!1,contentVisible:!1}),computed:{iconStyling:()=>({top:e.isWindowsOs()||e.isFirefox(),right:e.isFirefox()}),title(){return`${this.source} Requires Additional Permissions`},description(){return`${this.reason}, ${this.source} needs additional permissions.`}},created(){this.requestImmediately&&!t()&&this.requestPermissions()},mounted(){m.widgetManager.hideApps({layer:"permissions"}),this.contentVisible=!0,this.watchPermissionCheck&&(i().permissions.onAdded.addListener(this.resolveIfGrantedFromWatcher),i().permissions.onRemoved.addListener(this.resolveIfGrantedFromWatcher))},destroyed(){m.widgetManager.showApps({layer:"permissions"}),this.watchPermissionCheck&&(i().permissions.onAdded.removeListener(this.resolveIfGrantedFromWatcher),i().permissions.onRemoved.removeListener(this.resolveIfGrantedFromWatcher))},methods:{requestPermissions(){this.browserRequestOpen=!0,r.permissions.request(this.permissions).then((s=>this.resolvePermissionRequest(s)),(s=>{console.error(s),this.resolvePermissionRequest(!1)}))},async resolvePermissionRequest(s){this.contentVisible=!1,await this.$nextTick(),this.resolve(s),this.$emit("dismiss")},resolveIfGrantedFromWatcher(){r.permissions.contains(this.permissions).then((s=>{s&&this.resolvePermissionRequest(!0)}))}}},(function(){var s=this,e=s._self._c;return e("div",{staticClass:"permission-overlay dark",attrs:{"data-test":"permission-overlay"}},[e("transition",{attrs:{name:"slide-down-fade",mode:"out-in"}},[s.contentVisible?e("div",{staticClass:"upper"},[e("div",{staticClass:"title"},[s._v(s._s(s.title))]),e("div",{staticClass:"description"},[s._v(s._s(s.description))]),s.extraInstructions?e("div",{staticClass:"extra-instructions"},[s._v(s._s(s.extraInstructions))]):s._e(),e("smooth-reflow",[s.browserRequestOpen?s._e():e("div",{staticClass:"action-buttons-wrapper"},[e("div",{staticClass:"privacy"},[s._v("We value and protect your privacy. Learn more in our "),e("a",{attrs:{href:"https://momentumdash.com/legal/privacy",target:"_blank"}},[s._v("Privacy Policy.")])]),e("div",{staticClass:"button-row"},[e("div",{staticClass:"dash-button dash-button-neutral",attrs:{"data-test":"deny-permissions"},on:{click:function(e){return s.resolvePermissionRequest(!1)}}},[s._v("Go back")]),e("div",{staticClass:"dash-button dash-button-primary",attrs:{"data-test":"allow-permissions"},on:{click:s.requestPermissions}},[s._v("Continue")])])])]),e("smooth-reflow",{staticClass:"arrow-wrapper",class:s.iconStyling},[s.browserRequestOpen?e("div",[e("div",{staticClass:"icon"},[e("inline-svg",{staticClass:"icon",attrs:{src:n}})],1)]):s._e()])],1):s._e()]),e("div",{staticClass:"center"}),e("div",{staticClass:"lower"})],1)}),[],!1,null,"76ceee60").exports;export{a as default};