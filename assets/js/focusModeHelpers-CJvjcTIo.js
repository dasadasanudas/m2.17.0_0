const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/countdownCollection-CADcGJSY.js","assets/js/preload-helper-xKIU3iAw.js","assets/js/VueBase-DhIJfHAY.js","assets/js/icon-alert-Cei3Tz55.js","assets/js/localStorage-BThj8CCp.js","assets/js/string-CbqVM-Zr.js","assets/js/index-xreAsusa.js","assets/js/migrateLegacyUserMessageHandler-aPkGeFs_.js","assets/js/main-Bw6ngw5x.js","assets/css/index-C0DDMXTO.css","assets/js/index-CJJH83pl.js","assets/js/portal-vue.esm-D8ZiK_2v.js","assets/js/itemModelMixin-C-MQn-VF.js","assets/js/reactiveCustomization-D0v-tpvX.js","assets/js/namesMixin-1rfnIeIW.js","assets/js/itemDataServiceMixins-CdQVI9mg.js","assets/js/metricMetadata-D4pZaGht.js","assets/js/clocks-DjzskNOU.js","assets/js/captureMixin-DkvxYfHw.js","assets/js/metricCollection-B-EWIxcl.js","assets/js/clockCollection-H7tQVeU0.js","assets/js/focusCollection-MZ20QYHH.js","assets/js/addin-eV6CQgSY.js","assets/js/style-DUHjVTJK.js","assets/js/ViewState-Wts6aMTb.js","assets/css/style-CebYLhf0.css","assets/js/handlebarLoader-xbtIzd6B.js","assets/js/linksViewState-C6HnJDbT.js","assets/js/links-BP32jl2s.js","assets/js/compareObjects-BF7sSNEf.js","assets/js/tabsViewState-LtACuIyl.js","assets/js/tabs-D23wVUv9.js","assets/js/focusModeViewState-DzdkaS0D.js","assets/js/PomodoroTimers-BWkB-14p.js","assets/js/pomodoroCompleted-CChcDNoN.js","assets/js/loginHelpers-CQ1ZDpQp.js","assets/js/authService-piMSfLVB.js","assets/js/customization-C9MvloB8.js","assets/js/siteBlockerGroups-BWyYGTCQ.js","assets/js/constants-DNx-NqfY.js","assets/js/siteBlockerSession-DLWrywXh.js","assets/js/soundsPlayer-CXHWl8nc.js","assets/js/state-Te6231FT.js","assets/js/IframeMessenger-CZMsBVeI.js"])))=>i.map(i=>d[i]);
import{u as e,b as t,w as s,M as a,d as i,aj as o}from"./icon-alert-Cei3Tz55.js";import{A as n,p as l,e as c,M as r,C as d,V as u,B as p}from"./index-xreAsusa.js";import{b as f,p as b}from"./reactiveCustomization-D0v-tpvX.js";import{_}from"./preload-helper-xKIU3iAw.js";import{a as w}from"./PomodoroTimers-BWkB-14p.js";const h={countdowns:()=>V(_((()=>import("./countdownCollection-CADcGJSY.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]))),metrics:()=>V(_((()=>import("./metricCollection-B-EWIxcl.js").then((e=>e.b))),__vite__mapDeps([19,1,2,3,4,5,6,7,8,9,10,11,15,12,13,14,16,17,18]))),clocks:()=>V(_((()=>import("./clockCollection-H7tQVeU0.js")),__vite__mapDeps([20,1,2,3,4,5,6,7,8,9,10,11,15,12,13,14,16,17,18]))),focus:()=>V(_((()=>import("./focusCollection-MZ20QYHH.js")),__vite__mapDeps([21,2,3,4,1,5,6,7,8,9,10,11,12,13,14,22,23,24,25,26]))),linksViewStateStore:()=>V(_((()=>import("./linksViewState-C6HnJDbT.js")),__vite__mapDeps([27,24,3,4,1,5,8,6,7,9]))),linksStore:()=>V(_((()=>import("./links-BP32jl2s.js").then((e=>e.l))),__vite__mapDeps([28,3,4,1,5,6,7,8,9,29]))),tabsViewStateStore:()=>V(_((()=>import("./tabsViewState-LtACuIyl.js")),__vite__mapDeps([30,24,3,4,1,5,8]))),tabsStore:()=>V(_((()=>import("./tabs-D23wVUv9.js").then((e=>e.t))),__vite__mapDeps([31,3,4,1,5]))),focusModeViewStateStore:()=>V(_((()=>import("./focusModeViewState-DzdkaS0D.js")),__vite__mapDeps([32,3,4,1,5,24,8,6,7,9,13,2,10,11,33]))),focusModeSessionStore:()=>V(_((()=>Promise.resolve().then((()=>S))),void 0))};async function V(e){return(await e).default}const y={pomodoro:{enable:async()=>{m.trigger("centerBelow:show",!1);const s=(await _((async()=>{const{default:e}=await import("./pomodoroCompleted-CChcDNoN.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([34,3,4,1,5,6,7,8,9,33,13,2,10,11,35,36,37]))).default();return await e((()=>s.loaded)).toBe(!0),s.playing||await s.switchTo(w.Focus,{playSounds:!0}),t.delay(n).then((async()=>{m.trigger("pomodoro:focusPromptIfFocusEmpty"),await t.delay(n),m.trigger("pomodoro:focusPromptIfFocusEmpty")})),!0},disable:async()=>{const t=(await _((async()=>{const{default:e}=await import("./pomodoroCompleted-CChcDNoN.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([34,3,4,1,5,6,7,8,9,33,13,2,10,11,35,36,37]))).default();await e((()=>t.loaded)).toBe(!0),await t.complete({switchAfterComplete:!1,completedManually:!0})}},siteBlocker:{enable:async()=>{const e=(await _((async()=>{const{default:e}=await import("./siteBlockerGroups-BWyYGTCQ.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([38,3,4,1,5,39,29]))).default(),t=(await _((async()=>{const{default:e}=await import("./siteBlockerGroups-BWyYGTCQ.js").then((e=>e.s));return{default:e}}),__vite__mapDeps([38,3,4,1,5,39,29]))).default();e.refresh(),t.refresh();return(await _((async()=>{const{default:e}=await import("./siteBlockerSession-DLWrywXh.js");return{default:e}}),__vite__mapDeps([40,3,4,1,5,6,7,8,9,38,39,29,32,24,13,2,10,11,33,34,35,36,37]))).default().active},disable:async({enableResult:e,focusing:t})=>{if(t)return;(await _((async()=>{const{default:e}=await import("./siteBlockerSession-DLWrywXh.js");return{default:e}}),__vite__mapDeps([40,3,4,1,5,6,7,8,9,38,39,29,32,24,13,2,10,11,33,34,35,36,37]))).default().toggleActive(!!e)},shouldEnableOnResume:()=>!0,shouldRemoveDataOnSettingsChangeWhileFocusing:!1},soundscapes:{enable:async()=>{var t;const s=(await _((async()=>{const{default:e}=await import("./soundsPlayer-CXHWl8nc.js").then((e=>e.s));return{default:e}}),__vite__mapDeps([41,6,1,3,4,5,7,8,9,42,24,43,32,13,2,10,11,33,34,35,36,37]))).default();return s.refresh(),await e((()=>s.loadedAllItems)).toBe(!0),null==(t=s.activeItem)?void 0:t.id},disable:async({enableResult:e,focusing:t})=>{if(t)return;if(!e)return;(await _((async()=>{const{default:e}=await import("./soundsPlayer-CXHWl8nc.js").then((e=>e.s));return{default:e}}),__vite__mapDeps([41,6,1,3,4,5,7,8,9,42,24,43,32,13,2,10,11,33,34,35,36,37]))).default().play(e)},shouldEnableOnResume:()=>!0},tabStash:{enable:()=>{},disable:async({enableResult:e,inactive:a})=>{var i;if(a)return;const o=(await h.tabsStore())();if(o.loaded&&!o.loading||(await new Promise((e=>{s((()=>o.loaded),e),o.loading||o.refresh()})),await t.delay(1e3)),m.conditionalFeatures.featureEnabled("plus")||m.conditionalFeatures.featureEnabled("tab-stash-degraded")||(e=null==(i=o.getItems[0])?void 0:i.id),"string"==typeof e){const t=o.getItemById(e);t&&await o.restoreSession(t)}},get unsupported(){return t.isSafari()||t.isPwa()}}},g=["siteBlocker","soundscapes","tabStash"];let A;const E=l((({loadedRef:e,updateAsync:s})=>i("focusModeSession",{state:()=>({start:1,stop:1,appActivationData:{},capacityLimitInfo:{msUsed:0,date:t.getDateOnly(new Date)},lastInteraction:Date.now(),totalTimeFocused:0}),getters:{focusModeActive:e=>!e.stop,loaded:()=>e.value,capacityLimitInfoForToday(){const e=this.capacityLimitInfo,s=m.models.date.get("date"),a=t.getDateOnly(s);return e.date!==a?{date:a,msUsed:0}:e},msUntilOverCapacityLimit(){const e=d,t=this.capacityLimitInfoForToday.msUsed,s=m.models.date.get("seconds").getTime();return e-(t+(this.focusModeActive?s-this.start:0))},isOverCapacityLimit(){return this.msUntilOverCapacityLimit<=0},shouldAutoDisable(){const e=m.models.date.get("date").getTime();return this.focusModeActive&&this.lastInteraction<e-r},totalTimeFocusedIncludingCurrentSession(){const e=m.models.date.get("date").getTime();let t=this.totalTimeFocused;return this.focusModeActive&&(t+=e-this.start),Math.max(t,0)}},actions:{async update(e){await s(e)},async stopAndSaveFocusMode(){const e=this.capacityLimitInfoForToday,t=Date.now(),s=t-this.start;e.msUsed+=s;const a=this.totalTimeFocused+s;await this.update({stop:t,capacityLimitInfo:e,totalTimeFocused:a,appActivationData:{}}),this.refreshLastInteraction({debounceTime:0})},async startAndSaveFocusMode(e){const t=this.capacityLimitInfoForToday;await this.update({start:Date.now(),stop:null,appActivationData:e,capacityLimitInfo:t}),this.refreshLastInteraction({debounceTime:0})},refreshLastInteraction({debounceTime:e=3e3}){this.focusModeActive&&(clearTimeout(A),A=window.setTimeout((()=>{this.update({lastInteraction:Date.now()})}),e))},async disableAppsBeforeStop(e){for(const t of g){const s=y[t];s.unsupported||await s.disable({enableResult:this.appActivationData[t],inactive:e})}}}})),{mode:a.Cache,syncAutomatically:!0});(async()=>{const t=E();await e((()=>t.loaded)).toBe(!0),c.switchOverToWatchedStoreItem((()=>t.focusModeActive))})();const S=Object.freeze(Object.defineProperty({__proto__:null,default:E,useFocusModeSessionStore:E},Symbol.toStringTag,{value:"Module"})),I=()=>{const e=f.focusModeSettings,t=JSON.parse(m.models.customization.persistentSettings.defaultIfNotSet.focusModeSettingsStr);return e.apps={...t.apps,...e.apps},{...t,...e}},v=()=>b,T=async(e,t,s)=>{const a=v().focusModeSettings;a.apps[e]||(a.apps[e]={enabled:!1}),a.apps[e][t]=s,v().focusModeSettings=a,E().focusModeActive&&(await(async(e,t)=>{const s=E(),a=s.appActivationData||{};if(t){const t=await y[e].enable();if(null==t)return;a[e]=t}else await y[e].disable({enableResult:a[e],focusing:!0}),(y[e].shouldRemoveDataOnSettingsChangeWhileFocusing??1)&&delete a[e];await s.update({appActivationData:a})})(e,s),M())},M=()=>{const e=I(),t={notesVisible:e.notesVisible,todoVisible:e.todoVisible,quoteVisible:!1,siteBlockerVisible:e.apps.siteBlocker.enabled,soundscapesVisible:e.apps.soundscapes.enabled,tabsVisible:e.apps.tabStash.enabled,focusVisible:!0,centerBelowNavVisible:e.searchVisible,searchVisible:!1,launchpadVisible:!1,focusModeVisible:!0,askAiVisible:e.askAiVisible,linksVisible:e.linksVisible,metricVisible:e.metricsVisible,countdownVisible:e.countdownsVisible,multiClockVisible:e.worldClocksVisible,focusInsightVisible:e.focusInsightVisible,weatherVisible:!1};o(t)},D=()=>{m.widgetManager.addVueAppExemption(u,"focusMode"),m.widgetManager.addAppExemption(p,"focusMode")},L=()=>{m.widgetManager.hideApps({layer:"focusMode"}),m.widgetManager.removeVueAppExemption(u,"focusMode"),m.widgetManager.removeAppExemption(p,"focusMode")},O=()=>{o({soundscapesVisible:!!m.conditionalFeatures.featureEnabled("plus")&&null,tabsVisible:!(!m.conditionalFeatures.featureEnabled("tab-stash-degraded")&&!m.conditionalFeatures.featureEnabled("plus"))&&null,notesVisible:null,todoVisible:null,quoteVisible:null,siteBlockerVisible:null,focusVisible:null,centerBelowNavVisible:null,searchVisible:null,launchpadVisible:null,focusModeVisible:null,askAiVisible:null,linksVisible:null,metricVisible:null,countdownVisible:null,multiClockVisible:null,focusInsightVisible:null,weatherVisible:null})},R=async()=>{if(c.currentValue){const e=(await h.focusModeSessionStore())();await e.disableAppsBeforeStop(!1),await e.stopAndSaveFocusMode()}};export{D as a,O as b,y as c,v as d,T as e,R as f,I as g,S as h,h as i,L as r,M as s,E as u};