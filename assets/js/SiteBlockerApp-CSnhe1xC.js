import{q as e,B as t,a5 as i,n as s,L as o,f as r}from"./icon-alert-Cei3Tz55.js";import{A as n}from"./AppPopup-BwTiSELh.js";import{A as a}from"./AppViewSwitchDynamic-DCOLomdp.js";import{u as p,S as l}from"./main-rV_h-8zJ.js";import{A as c}from"./AppView-CLCF208Q.js";import{a as u,A as m,b as d}from"./AppHeader-qzvUiXuB.js";import{B as b}from"./BaseIcon-DKpoUDYB.js";import{B as w}from"./BaseItemList-DZ-fAhZy.js";import{u as h,a as g,S as f}from"./siteBlockerGroups-BWyYGTCQ.js";import{T as v}from"./ToggleSwitch-cciEx5Ka.js";import{F as S}from"./FormEditableSpan-AMyq4j5l.js";import{B as k}from"./BaseForm-BUqGxpHs.js";import{A as y}from"./AppLoading-B4vn2HVx.js";import j from"./siteBlockerSession-DLWrywXh.js";import{F as I}from"./FavIcon-ilXdVA7k.js";import{a as A}from"./string-CbqVM-Zr.js";import{A as C}from"./AppEmpty-ChhIi3BX.js";import{e as B}from"./index-xreAsusa.js";import{A as _}from"./AppButtonRow-Ih2AzPHL.js";import{A as G}from"./AppActionBanner-CioGZkgY.js";import{A as x}from"./AppHeaderControl-DmqWUMjw.js";import{B as R}from"./BaseDropdown-BnEBcF3g.js";import{B as D}from"./BaseDropdownOption--ggIz8bI.js";import{c as W}from"./preload-helper-xKIU3iAw.js";import{A as P,a as N}from"./AppConfirmCancel-DNZu3YDY.js";import"./localStorage-BThj8CCp.js";import"./globalKeyEventManager-2_REwTdI.js";import"./SmoothReflow-DOlTFzdt.js";import"./allComponentsMounted-C3UsG_cA.js";import"./VueBase-DhIJfHAY.js";import"./index-CJJH83pl.js";import"./portal-vue.esm-D8ZiK_2v.js";import"./AppContainer-CuCmPr8M.js";import"./showAnyway-IMtKhwyy.js";import"./reactiveCustomization-D0v-tpvX.js";import"./migrateLegacyUserMessageHandler-aPkGeFs_.js";import"./main-Bw6ngw5x.js";import"./appToggleMixin-YpT44oar.js";import"./ViewState-Wts6aMTb.js";import"./AppDash-CHdOMoU_.js";import"./icon-hide-NFfBhfBx.js";import"./arrow-Be8MuPJi.js";import"./icon-weather-reset-CoyptBb8.js";import"./icon-settings-Bycjf8-G.js";import"./icon-back-arrow-CiRQJ6G-.js";import"./icon-back-D_TFrgyJ.js";import"./icon-trash-BQ1O-AfY.js";import"./icon-close-BUGl_M7j.js";import"./icon-cog-BFr_Pva7.js";import"./icon-skip-BOkC5L0N.js";import"./icon-down-BiHbKN-t.js";import"./icon-edit-CixeXNYx.js";import"./icon-ellipsis-D3jS4u3x.js";import"./icon-error-state-BKQhfBCj.js";import"./icon-heart-v5O7C6eS.js";import"./icon-key-BPNRipb3.js";import"./icon-next-B4hjdiAA.js";import"./icon-photo-BrwqV1T0.js";import"./icon-pin-BHeOuzvO.js";import"./icon-plus-D4YOesIc.js";import"./icon-profile-B_XWyuTb.js";import"./icon-x-qUCmf2CW.js";import"./icon-skip-intro-BUi8b3Ak.js";import"./icon-tooltip-CN09iXOB.js";import"./icon-visible-on-CM3kpcFN.js";import"./icon-x-caret-half-CZtcH_PM.js";import"./tasks-completed-Dg2z75km.js";import"./add-COIuonao.js";import"./google-DKPAcOmk.js";import"./arrow-up-1QPpu78M.js";import"./square-check-DwLT60gj.js";import"./clocks-DjzskNOU.js";import"./close-Bj_A2br_.js";import"./search-DCqlmJx6.js";import"./folder-CwWTWsnJ.js";import"./switch-EuBTQVVE.js";import"./focus-mode-09pIyYAW.js";import"./storage-YYEO5TB5.js";import"./icon-confetti-Dz2LojDe.js";import"./sparks-CAw9b6ob.js";import"./secure-B8YP-AML.js";import"./icon-asana-Csd73e1k.js";import"./icon-soundwave-CtfxieWt.js";import"./icon-percent-schedule-CA5EI9b7.js";import"./icon-trello-DeIn-36G.js";import"./icon-clean-rFsPxTtp.js";import"./icon-more-lists-Cl9oRGK2.js";import"./icon-more-fonts-CcfOY0t4.js";import"./icon-focus-stats-keERwXFt.js";import"./icon-top-of-mind-B6EhbCcK.js";import"./icon-flow-5QqmGIWX.js";import"./icon-integrations-D9o58ob4.js";import"./icon-weather-extra-ufLpT_SX.js";import"./icon-spiral-gh4hwZDD.js";import"./icon-time-sensitive-CP2L3maw.js";import"./icon-hourly-CdMmiQZT.js";import"./icon-infinity-D4yMRoAd.js";import"./icon-personalize-photos-D2M4lLlt.js";import"./icon-skip-2bGCAGKt.js";import"./icon-photo-match-C2EChNEK.js";import"./icon-random-375DbcwF.js";import"./icon-timezones-DGZoTtaT.js";import"./icon-simplify-BRUtLJYp.js";import"./icon-sync-DIH26Y9h.js";import"./constants-BpVlFj04.js";import"./constants-DNx-NqfY.js";import"./compareObjects-BF7sSNEf.js";import"./FormMessage-CGWi8obs.js";import"./focusModeViewState-DzdkaS0D.js";import"./focusModeHelpers-CJvjcTIo.js";import"./PomodoroTimers-BWkB-14p.js";import"./pomodoroCompleted-CChcDNoN.js";import"./loginHelpers-CQ1ZDpQp.js";import"./authService-piMSfLVB.js";import"./customization-C9MvloB8.js";import"./BaseDropdownContent-CE_Bs11r.js";import"./constants-CALDQiUE.js";import"./index-CAmMGhGv.js";const V=e({name:"SiteBlockerGroupsListItem",components:{BaseForm:k,FormEditableSpan:S,BaseIcon:b,ToggleSwitch:v},props:{group:{type:Object,required:!0},newGroup:{type:Boolean,default:!1}},setup:()=>({groupsStore:h(),viewStateStore:p(),inlineInputRef:t(),formRef:t(),capture:i("capture")}),mounted(){var e;this.newGroup&&(null==(e=this.inlineInputRef)||e.focus())},methods:{toggleEnabled(){var e;if(this.group.enabled=!this.group.enabled,!this.newGroup)return null==(e=this.capture)||e.call(this,"site blocker toggle group",{defaultKey:this.group.defaultKey}),this.groupsStore.update(this.group.id,{enabled:this.group.enabled})},createNewGroup(){var e;if(this.newGroup)return this.group.validate(),this.groupsStore.clearActiveItem(),null==(e=this.capture)||e.call(this,"site blocker create new group",{defaultKey:this.group.defaultKey}),this.groupsStore.create(this.group)},async goToGroupWebsitesIfNotNewGroup(){var e;this.newGroup||(this.groupsStore.editItem(this.group.id),await(null==(e=this.viewStateStore)?void 0:e.setActiveView(l.Websites)))}}});const M=s(e({name:"SiteBlockerGroupsList",components:{BaseIcon:b,SiteBlockerGroupsListItem:s(V,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("li",{staticClass:"site-blocker-groups-list-item app-list-item-lines-between",attrs:{"data-test":"groups-list-item"},on:{click:e.goToGroupWebsitesIfNotNewGroup}},[t("base-form",{ref:"formRef",staticClass:"list-item-form",attrs:{submit:e.createNewGroup,"submit-button":!1,"submit-on-blur":!0}},[t("div",{staticClass:"list-item-content",class:{editing:e.newGroup}},[t("form-editable-span",{ref:"inlineInputRef",staticClass:"group-websites-input",attrs:{name:"name-input",editing:e.newGroup,placeholder:"New group","data-test":"groups-list-item-input"},model:{value:e.group.name,callback:function(t){e.$set(e.group,"name",t)},expression:"group.name"}}),e.newGroup?e._e():t("span",{staticClass:"group-websites-count"},[e._v(e._s(e.group.totalWebsites))]),t("toggle-switch",{attrs:{value:e.group.enabled,"data-test":"groups-list-item-toggle"},on:{click:function(t){return t.stopPropagation(),e.toggleEnabled.apply(null,arguments)}}}),t("div",{staticClass:"icon-wrapper group-websites-view u--mobile-show-bg",class:{disabled:e.newGroup},attrs:{"data-test":"groups-list-item-websites"}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-next",size:"10px"}})],1)],1)])],1)}),[],!1,null,"7bfe9cca").exports,BaseItemList:w},setup:()=>({groupsStore:h()}),computed:{editingExistingGroup(){return!!this.groupsStore.activeItem&&!!this.groupsStore.getGroupOrDefaultFromId(this.groupsStore.activeItem.id)}},methods:{createNewGroup(){this.groupsStore.newItem()}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"site-blocker-groups-list"},[t("div",{staticClass:"groups-header"},[t("span",{staticClass:"groups-header-title"},[e._v("Blocked groups")]),t("div",{staticClass:"icon-wrapper",attrs:{"data-test":"new-group"},on:{click:e.createNewGroup}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-plus",size:"12px"}})],1)]),t("base-item-list",[e.groupsStore.activeItem&&!e.editingExistingGroup?t("site-blocker-groups-list-item",{key:e.groupsStore.activeItem.id,attrs:{group:e.groupsStore.activeItem,"new-group":!0}}):e._e(),e._l(e.groupsStore.items,(function(e){return t("site-blocker-groups-list-item",{key:e.id,attrs:{group:e}})}))],2)],1)}),[],!1,null,"c9a82ea7").exports,E=e({name:"SiteBlockerGroupsBlockingBannerIcon",components:{FavIcon:I},props:{url:{type:String,required:!0}},setup:()=>({yDisplacement:"0rem",xDisplacement:"0rem",animationStart:"0s",animationSpeed:"10s"}),created(){this.yDisplacement=4*Math.random()-2+"rem",this.xDisplacement=2.25*Math.random()+1.5+"rem";const e=5*Math.random()+35;this.animationSpeed=e+"s",this.animationStart=-1*Math.random()*e+"s"}}),O=()=>{o(((e,t)=>({"99fb043a":e.xDisplacement,"201f1e6f":e.animationSpeed,"2020e28a":e.animationStart,bcf4f738:e.yDisplacement})))},F=E.setup;E.setup=F?(e,t)=>(O(),F(e,t)):O;const T=e({name:"SiteBlockerGroupsBlockingBanner",components:{SiteBlockerGroupsBlockingBannerIcon:s(E,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"site-blocker-groups-blocking-banner-icon"},[t("fav-icon",{staticClass:"favicon",attrs:{url:e.url}})],1)}),[],!1,null,"b6e1f749").exports,BaseIcon:b},setup:()=>({sessionStore:j(),iconRangeInterval:void 0}),data:()=>({visibleIconRangeMin:0,visibleIconRangeMax:0,iconsVisible:!1}),computed:{urls(){return""===this.sessionStore.urls?[]:this.sessionStore.urls.replaceAll("*","com").split(" ")}},watch:{urls(){this.setRandomIconRange()}},created(){this.setRandomIconRange(),this.iconRangeInterval=setInterval((()=>{this.visibleIconRangeMin=A(this.urls,this.visibleIconRangeMin,1),this.visibleIconRangeMax=A(this.urls,this.visibleIconRangeMax,1)}),5e3),setTimeout((()=>{this.iconsVisible=!0}),200)},destroyed(){clearInterval(this.iconRangeInterval)},methods:{setRandomIconRange(){const e=Math.floor(Math.random()*this.urls.length);this.visibleIconRangeMin=e,this.visibleIconRangeMax=A(this.urls,e,Math.min(this.urls.length-1,10))},isIconInRange(e){return this.visibleIconRangeMax<this.visibleIconRangeMin?e>=0&&e<=this.visibleIconRangeMax||e>=this.visibleIconRangeMin&&e<=this.urls.length-1:(e-this.visibleIconRangeMin)*(e-this.visibleIconRangeMax)<=0}}});const K=s(e({name:"SiteBlockerGroups",components:{AppActionBanner:G,AppButtonRow:_,AppEmpty:C,AppLoading:y,SiteBlockerGroupsBlockingBanner:s(T,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("transition-group",{staticClass:"site-blocker-groups-blocking-banner",attrs:{tag:"div",name:"slow-fade-icon"}},[t("div",{key:"blocking-browser",staticClass:"blocking-browser",attrs:{"data-test":"blocking-browser"}},[t("div",{staticClass:"blocking-nav"},[t("div",{staticClass:"nav-item"}),t("div",{staticClass:"nav-item"}),t("div",{staticClass:"nav-item"}),t("div",{staticClass:"nav-item nav-bar"})]),t("base-icon",{attrs:{src:"icon/denied",size:"2rem"}}),t("span",{staticClass:"blocking-message"},[e._v("Blocking distractions")])],1),e._l(e.urls,(function(i,s){return e.iconsVisible&&e.isIconInRange(s)?t("site-blocker-groups-blocking-banner-icon",{key:`${i}`,attrs:{url:i}}):e._e()}))],2)}),[],!1,null,"7ae7d69e").exports,SiteBlockerGroupsList:M,BaseIcon:b,AppHeader:u,AppView:c},setup:()=>({groupsStore:h(),websitesStore:g(),sessionStore:j(),capture:i("capture")}),computed:{loaded(){return this.groupsStore.loaded&&this.websitesStore.loaded},hasActiveItem(){return!!this.groupsStore.activeItem},empty(){return 0===this.groupsStore.items.length},focusModeActive:()=>B.currentValue,manualToggleControlsVisible(){return!this.focusModeActive&&!this.empty&&this.loaded}},created(){this.groupsStore.refresh(),this.websitesStore.refresh()},methods:{createNewGroup(){this.groupsStore.newItem()},async toggleBlockingActive(){var e;this.sessionStore.active||this.sessionStore.hasPermissions||await this.sessionStore.ensurePermissions(),this.sessionStore.toggleActive(),null==(e=this.capture)||e.call(this,"site blocker manual toggle active",{active:this.sessionStore.active})}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"site-blocker-groups",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{scopedSlots:e._u([{key:"left",fn:function(){return[t("base-icon",{staticClass:"app-header-icon",attrs:{src:"icon/apps/site-blocker",size:"16px"}}),t("span",{staticClass:"app-header-name"},[e._v("Site Blocker")])]},proxy:!0}])}),e.sessionStore.featureEnabled&&!e.sessionStore.hasPermissions?t("app-action-banner",{attrs:{"action-text":"Grant permissions",text:"We need new permissions to handle blocking sites","data-test":"grant-permissions"},on:{action:function(t){return e.sessionStore.ensurePermissions(!0)}}}):e._e(),e.sessionStore.featureEnabled||e.focusModeActive?e._e():t("app-action-banner",{attrs:{"action-text":"Renew",text:"Plus subscription expired."},on:{action:e.sessionStore.checkSiteBlockerFeatureDisabledAndOpenUpsell}}),e.manualToggleControlsVisible?t("app-button-row",[t("button",{staticClass:"button",attrs:{"data-test":"toggle-blocking"},on:{click:e.toggleBlockingActive}},[e._v(" "+e._s(e.sessionStore.active?"Stop":"Start")+" blocking websites ")])]):e._e()]},proxy:!0},{key:"body",fn:function(){return[t("transition",{attrs:{name:"fade-fast",mode:"out-in"}},[e.loaded?t("div",[e.empty&&!e.hasActiveItem?t("app-empty",{attrs:{title:"Add a group to get started","button-text":"Add Group","button-data-test":"new-group-empty"},on:{buttonClick:e.createNewGroup}}):[t("transition",{attrs:{name:"blocking-fade"}},[e.sessionStore.activeAndBlockingUrls?t("site-blocker-groups-blocking-banner",{class:{"toggle-visible":e.manualToggleControlsVisible}}):e._e()],1),t("site-blocker-groups-list")]],2):t("app-loading",{attrs:{"data-test":"groups-loading"}})],1)]},proxy:!0}])})}),[],!1,null,"85585224").exports;const L=s(e({name:"BaseDropdownConfirmation",components:{AppConfirmCancel:P},props:N,emits:["cancel","delete"],setup:()=>({AppConfirmCancelType:m})}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("app-confirm-cancel",e._g(e._b({attrs:{"data-test":"dropdown-confirm-delete"}},"app-confirm-cancel",e.$props,!1),e.$listeners))],1)}),[],!1,null,"7f4cb52f").exports,U=e({name:"SiteBlockerWebsitesListItem",components:{BaseDropdownConfirmation:L,FormEditableSpan:S,BaseForm:k,FavIcon:I,BaseIcon:b,BaseDropdownOption:D,BaseDropdown:R,ToggleSwitch:v},props:{website:{type:Object,required:!0},editing:{type:Boolean,default:!1},newWebsite:{type:Boolean,default:!1}},setup:()=>({viewStateStore:p(),websitesStore:g(),websitesDropdownRef:t(),inputNameRef:t(),inputUrlRef:t(),capture:i("capture")}),computed:{urlNameIfEmpty(){var e,t;if(this.website.name)return this.website.name;const i=null==(t=null==(e=this.website.url)?void 0:e.split("."))?void 0:t.at(-2);return i&&i.length>4&&W(i)||""},namePlaceholder(){return""===this.website.url||""===this.urlNameIfEmpty?"Website Name":this.urlNameIfEmpty},dropdownConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===m.Dropdown}},mounted(){var e;this.newWebsite&&(null==(e=this.inputUrlRef)||e.focus())},methods:{toggleEnabled(){var e;if(this.website.enabled=!this.website.enabled,!this.newWebsite)return null==(e=this.capture)||e.call(this,"site blocker toggle website"),this.websitesStore.update(this.website.id,{enabled:this.website.enabled})},async editWebsite(e){var t,i,s,o,r;(!this.websitesStore.activeItem||!this.editing&&await(null==(t=this.viewStateStore)?void 0:t.setConfirmation({title:"Are you sure you want to edit?",description:"All unsaved changes will be lost!",type:m.Dropdown})))&&(null==(i=this.capture)||i.call(this,"site blocker edit website",{defaultKey:this.website.defaultKey}),this.websitesStore.editItem(this.website.id)),null==(s=this.websitesDropdownRef)||s.closeDropdown(),await this.$nextTick(),e?null==(o=this.inputNameRef)||o.focus():null==(r=this.inputUrlRef)||r.focus()},async deleteWebsite(){var e,t,i,s;await(null==(e=this.viewStateStore)?void 0:e.setConfirmation({title:"Are you sure you want to delete?",type:m.Dropdown}))&&(null==(t=this.websitesDropdownRef)||t.closeDropdown(),await this.websitesStore.delete(this.website.id),null==(i=this.capture)||i.call(this,"site blocker delete website",{defaultKey:this.website.defaultKey}),(null==(s=this.websitesStore.activeItem)?void 0:s.id)===this.website.id&&this.websitesStore.clearActiveItem())},validateWebsite(){this.website.name=this.urlNameIfEmpty,this.website.validate()},async createNewWebsiteOrUpdateIfNameUrl(){var e,t;if(this.editing)return this.websitesStore.clearActiveItem(),this.newWebsite?(null==(e=this.capture)||e.call(this,"site blocker create website",{defaultKey:this.website.defaultKey}),this.websitesStore.create(this.website)):(null==(t=this.capture)||t.call(this,"site blocker update website",{defaultKey:this.website.defaultKey}),this.websitesStore.update(this.website.id,{name:this.website.name,url:this.website.url}))},clearConfirmationIfOpen(e){this.viewStateStore&&e&&(this.viewStateStore.confirmationProps=null)}}});const $=e({name:"SiteBlockerWebsitesList",components:{SiteBlockerWebsitesListItem:s(U,(function(){var e,t,i=this,s=i._self._c;return i._self._setupProxy,s("li",{staticClass:"site-blocker-websites-list-item app-list-item-lines-between",attrs:{"data-test":"websites-list-item"}},[s("base-form",{staticClass:"list-item-form",class:{editing:i.editing},attrs:{submit:i.createNewWebsiteOrUpdateIfNameUrl,validate:i.validateWebsite,"submit-button":!1,"submit-on-blur":!0}},[s("div",{staticClass:"list-item-top-row"},[i.editing?i._e():s("fav-icon",{staticClass:"url-favicon",attrs:{url:i.website.urlWithReplacedWildcard}}),s("form-editable-span",{ref:"inputNameRef",staticClass:"name-input",attrs:{editing:i.editing,name:"name-input",placeholder:i.namePlaceholder,"data-test":"websites-list-item-name-input"},nativeOn:{dblclick:function(e){return i.editWebsite(!0)}},model:{value:i.website.name,callback:function(e){i.$set(i.website,"name",e)},expression:"website.name"}}),s("toggle-switch",{attrs:{value:i.website.enabled,"data-test":"websites-list-item-toggle"},on:{click:i.toggleEnabled}}),s("base-dropdown",{ref:"websitesDropdownRef",attrs:{"data-test":"website-options-dropdown"},on:{toggle:i.clearConfirmationIfOpen}},[i.dropdownConfirmationVisible&&(null==(e=i.viewStateStore)?void 0:e.confirmationProps)?s("base-dropdown-confirmation",i._b({},"base-dropdown-confirmation",null==(t=i.viewStateStore)?void 0:t.confirmationProps,!1)):[s("base-dropdown-option",{attrs:{"data-test":"edit-website"},on:{click:function(e){return i.editWebsite(!1)}}},[s("base-icon",{staticClass:"icon",attrs:{src:"icon-edit"}}),i._v(" Edit ")],1),s("base-dropdown-option",{attrs:{"data-test":"delete-website"},on:{click:i.deleteWebsite}},[s("base-icon",{staticClass:"icon",attrs:{src:"icon/delete"}}),i._v(" Delete ")],1)]],2)],1),s("div",{staticClass:"list-item-bottom-row"},[s("form-editable-span",{ref:"inputUrlRef",staticClass:"url-input",attrs:{editing:i.editing,name:"url-input",placeholder:"URL","data-test":"websites-list-item-url-input"},nativeOn:{dblclick:function(e){return i.editWebsite(!1)}},model:{value:i.website.url,callback:function(e){i.$set(i.website,"url",e)},expression:"website.url"}})],1)])],1)}),[],!1,null,"98e8b575").exports,BaseItemList:w},setup:()=>({websitesStore:g(),groupsStore:h()}),computed:{activeGroup(){return this.groupsStore.activeItem??new f({order:this.groupsStore.items.length})},websites(){return this.websitesStore.getWebsitesByGroup(this.activeGroup)},editingExistingWebsite(){return!!this.websitesStore.activeItem&&!!this.websitesStore.getWebsiteOrDefaultFromId(this.websitesStore.activeItem.id)}},methods:{createNewWebsite(){this.websitesStore.newItem(this.activeGroup)}}});const H=e({name:"SiteBlockerWebsites",components:{AppActionBanner:G,BaseDropdownConfirmation:L,BaseForm:k,AppEmpty:C,AppConfirmCancel:P,SiteBlockerWebsitesList:s($,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("base-item-list",[e.websitesStore.activeItem&&!e.editingExistingWebsite?t("site-blocker-websites-list-item",{key:e.websitesStore.activeItem.id,attrs:{website:e.websitesStore.activeItem,editing:!0,"new-website":!0}}):e._e(),e._l(e.websites,(function(i){var s,o;return t("site-blocker-websites-list-item",{key:i.id,attrs:{website:(null==(s=e.websitesStore.activeItem)?void 0:s.id)===i.id?e.websitesStore.activeItem:i,editing:(null==(o=e.websitesStore.activeItem)?void 0:o.id)===i.id}})}))],2)}),[],!1,null,null).exports,BaseDropdownOption:D,BaseDropdown:R,FormEditableSpan:S,AppHeaderControl:x,AppView:c,AppHeader:u,BaseIcon:b},setup:()=>({viewStateStore:p(),groupsStore:h(),websitesStore:g(),sessionStore:j(),nameInputRef:t(),groupDropdownRef:t(),capture:i("capture"),AppHeaderCenterAlignment:d}),data:()=>({editingGroupName:!1}),computed:{activeGroup(){return this.groupsStore.activeItem??new f({order:this.groupsStore.items.length})},hasActiveItem(){return!!this.websitesStore.activeItem},empty(){return 0===this.websitesStore.getWebsitesByGroup(this.activeGroup).length},overlayConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===m.Overlay},dropdownConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===m.Dropdown}},mounted(){this.viewStateStore&&(this.viewStateStore.beforeViewChange=()=>(this.editingGroupName||this.websitesStore.activeItemHasChanges)&&this.viewStateStore?this.viewStateStore.setConfirmation({title:"Are you sure you want to cancel?",description:"All unsaved changes will be lost!",type:m.Overlay,dashboardOverlay:!0}):Promise.resolve(!0))},destroyed(){var e;null==(e=this.viewStateStore)||e.resetBeforeViewChange(),this.groupsStore.clearActiveItem(),this.websitesStore.clearActiveItem()},methods:{async goToGroups(){var e;await(null==(e=this.viewStateStore)?void 0:e.setActiveView(l.Groups))},createNewWebsite(){this.websitesStore.newItem(this.activeGroup)},async renameGroup(){var e,t;null==(e=this.groupDropdownRef)||e.closeDropdown(),this.editingGroupName=!0,await this.$nextTick(),null==(t=this.nameInputRef)||t.focus()},async deleteGroup(){var e,t,i;await(null==(e=this.viewStateStore)?void 0:e.setConfirmation({title:"Are you sure you want to delete this group?",type:m.Dropdown}))&&(null==(t=this.groupDropdownRef)||t.closeDropdown(),this.websitesStore.clearActiveItem(),null==(i=this.capture)||i.call(this,"site blocker delete group",{defaultKey:this.activeGroup.defaultKey}),await this.groupsStore.delete(this.activeGroup.id),await this.goToGroups())},updateGroupNameIfName(){var e;""!==this.activeGroup.name&&(this.editingGroupName=!1,null==(e=this.capture)||e.call(this,"site blocker update group",{defaultKey:this.activeGroup.defaultKey}),this.groupsStore.update(this.activeGroup.id,{name:this.activeGroup.name}))},clearConfirmationIfOpen(e){this.viewStateStore&&e&&(this.viewStateStore.confirmationProps=null)}}});const z=s(e({name:"SiteBlockerApp",components:{SiteBlockerWebsites:s(H,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"site-blocker-websites",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{scopedSlots:e._u([{key:"left",fn:function(){return[t("app-header-control",{on:{click:e.goToGroups}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon/arrow-left"}})],1),t("base-form",{staticClass:"group-name-form",attrs:{submit:e.updateGroupNameIfName,"submit-button":!1,"submit-on-blur":!0}},[t("form-editable-span",{ref:"nameInputRef",staticClass:"name-input app-header-name",attrs:{placeholder:"Edit group",editing:e.editingGroupName,"data-test":"websites-group-name-input"},nativeOn:{dblclick:function(t){return e.renameGroup.apply(null,arguments)}},model:{value:e.activeGroup.name,callback:function(t){e.$set(e.activeGroup,"name",t)},expression:"activeGroup.name"}})],1)]},proxy:!0},{key:"right",fn:function(){var i,s;return[t("app-header-control",{attrs:{"data-test":"new-website"},on:{click:e.createNewWebsite}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-plus"}})],1),t("base-dropdown",{ref:"groupDropdownRef",attrs:{"data-test":"group-options-dropdown"},on:{toggle:e.clearConfirmationIfOpen}},[e.dropdownConfirmationVisible&&(null==(i=e.viewStateStore)?void 0:i.confirmationProps)?t("base-dropdown-confirmation",e._b({},"base-dropdown-confirmation",null==(s=e.viewStateStore)?void 0:s.confirmationProps,!1)):[t("base-dropdown-option",{attrs:{"data-test":"edit-group"},on:{click:e.renameGroup}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-edit"}}),e._v(" Rename ")],1),t("base-dropdown-option",{attrs:{"data-test":"delete-group"},on:{click:e.deleteGroup}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon/delete"}}),e._v(" Delete ")],1)]],2)]},proxy:!0}])}),e.sessionStore.hasPermissions?e._e():t("app-action-banner",{attrs:{"action-text":"Grant permissions",text:"We need new permissions to handle blocking sites","data-test":"grant-permissions"},on:{action:function(t){return e.sessionStore.ensurePermissions(!0)}}})]},proxy:!0},{key:"body",fn:function(){return[e.empty&&!e.hasActiveItem?t("app-empty",{attrs:{title:"Add a website to get started","button-text":"Add Website","button-data-test":"new-website-empty"},on:{buttonClick:e.createNewWebsite}}):t("site-blocker-websites-list")]},proxy:!0},{key:"confirm",fn:function(){var i;return[e.overlayConfirmationVisible&&(null==(i=e.viewStateStore)?void 0:i.confirmationProps)?t("app-confirm-cancel",e._b({},"app-confirm-cancel",e.viewStateStore.confirmationProps,!1)):e._e()]},proxy:!0}])})}),[],!1,null,"0366f405").exports,SiteBlockerGroups:K,AppPopup:n,AppViewSwitchDynamic:a},setup:()=>({groupsStore:h(),websitesStore:g(),viewStateStore:p()}),computed:{groupsViewActive(){return this.viewStateStore.activeViewId===l.Groups},websitesViewActive(){return this.viewStateStore.activeViewId===l.Websites}},destroyed(){this.groupsStore.clearActiveItem(),this.websitesStore.clearActiveItem()},methods:{checkSiteBlockerGroupViewOpen(){this.groupsViewActive?r.$emit("siteBlockerGroups:opened"):r.$emit("siteBlockerGroups:closed")}}}),(function(){var e,t,i=this,s=i._self._c;return i._self._setupProxy,s("app-popup",{attrs:{position:"bottom-right",region:"top-left",width:320,focused:i.viewStateStore.focused},on:{close:function(e){return i.viewStateStore.togglePopup(!1)}},nativeOn:{click:function(e){return i.viewStateStore.focus()}}},[s("app-view-switch-dynamic",{attrs:{"order-key":null==(t=null==(e=i.viewStateStore)?void 0:e.activeView)?void 0:t.order},on:{afterTransition:i.checkSiteBlockerGroupViewOpen}},[i.groupsViewActive?s("site-blocker-groups"):i._e(),i.websitesViewActive?s("site-blocker-websites"):i._e()],1)],1)}),[],!1,null,"c9f31be7").exports;export{z as default};